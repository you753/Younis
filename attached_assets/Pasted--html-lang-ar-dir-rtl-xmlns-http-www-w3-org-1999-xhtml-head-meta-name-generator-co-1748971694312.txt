<html lang="ar" dir="rtl" xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta name="generator" content=
  "HTML Tidy for Linux (vers 25 March 2009), see www.w3.org" />
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>برنامج محاسبة احترافي</title>
  <link rel="stylesheet" href=
  "https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" type=
  "text/css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js" type="text/javascript">
</script>
  <style type="text/css">
/*<![CDATA[*/
        body {
            margin: 0;
            font-family: 'Cairo', Arial, sans-serif;
            background: linear-gradient(135deg, #e3f0ff 0%, #f9f9f9 100%);
            color: #222;
        }
        .container {
            display: flex;
            min-height: 100vh;
        }
        .sidebar {
            width: 270px;
            background: linear-gradient(135deg, #4f8cff 0%, #003366 100%);
            color: #fff;
            padding: 0;
            box-shadow: 2px 0 10px #0001;
            position: relative;
        }
        .sidebar h2 {
            text-align: center;
            padding: 30px 0 10px 0;
            margin: 0;
            font-size: 1.7em;
            letter-spacing: 2px;
            font-weight: bold;
        }
        .sidebar ul {
            list-style: none;
            padding: 0 0 30px 0;
            margin: 0;
        }
        .sidebar ul li {
            padding: 15px 30px 15px 20px;
            cursor: pointer;
            font-size: 1.1em;
            display: flex;
            align-items: center;
            transition: background 0.2s;
            border-bottom: 1px solid #ffffff22;
        }
        .sidebar ul li:hover, .sidebar ul li.active {
            background: #003366cc;
        }
        .sidebar ul li i {
            margin-left: 15px;
            font-size: 1.2em;
            min-width: 22px;
        }
        .submenu {
            background: #000000;
            margin: 0;
            padding: 0 0 0 0;
            display: none;
            border-right: 4px solid #ffd700;
        }
        .submenu li {
            padding: 12px 50px 12px 20px;
            font-size: 1em;
            border-bottom: 1px solid #ffffff11;
            background: #3a6db3;
        }
        .submenu li:hover, .submenu li.active {
            background: #ffd70033;
            color: #ffd700;
        }
        .sidebar ul li.has-submenu > i.fa-chevron-down {
            margin-right: auto;
            transition: transform 0.2s;
        }
        .sidebar ul li.has-submenu.open > i.fa-chevron-down {
            transform: rotate(180deg);
        }
        .main-content {
            flex: 1;
            padding: 40px 40px 40px 40px;
            background: #f9f9f9;
        }
        .cards {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            flex-wrap: wrap;
        }
        .card {
            flex: 1 1 200px;
            background: #fff;
            border-radius: 18px;
            box-shadow: 0 2px 12px #00336611;
            padding: 30px 25px;
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            min-width: 200px;
            max-width: 300px;
            margin-bottom: 10px;
        }
        .card i {
            font-size: 2.2em;
            margin-bottom: 10px;
            color: #1bcfcf;
        }
        .card .label {
            font-size: 1.1em;
            color: #888;
        }
        .card .value {
            font-size: 2em;
            font-weight: bold;
            margin-top: 5px;
        }
        .section {
            display: none;
        }
        .section.active {
            display: block;
        }
        .chart-container {
            background: #fff;
            border-radius: 18px;
            box-shadow: 0 2px 12px #00336611;
            padding: 30px 25px;
            margin-bottom: 30px;
            max-width: 700px;
        }
        /* Notification Bar Styles */
        .notification-bar {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background-color: #4CAF50;
            color: white;
            text-align: center;
            padding: 10px 0;
            z-index: 1000;
            display: none; /* Hidden by default */
            font-size: 1.1em;
        }
        @media (max-width: 900px) {
            .cards { flex-direction: column; gap: 15px; }
            .main-content { padding: 20px; }
        }
        /* Suppliers Table Styles */
        .suppliers-table-container {
            overflow-x: auto;
            margin-top: 20px;
        }
        .suppliers-table {
            width: 100%;
            border-collapse: collapse;
            background: #fff;
            border-radius: 12px;
            box-shadow: 0 2px 12px #00336611;
        }
        .suppliers-table thead {
            background: #f0f6ff;
        }
        .suppliers-table th, .suppliers-table td {
            padding: 12px 8px;
            border-bottom: 1px solid #eee;
            text-align: right;
        }
        .suppliers-table th {
            border-bottom: 2px solid #4f8cff;
        }
        .suppliers-table td .action-btn {
            background: #ffd700;
            color: #222;
            padding: 6px 14px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            margin-left: 5px;
            font-size: 1em;
        }
        .suppliers-table td .delete-btn {
            background: #ff4f4f;
            color: #fff;
        }
        .form-section {
            background: #fff;
            border-radius: 18px;
            box-shadow: 0 2px 12px #00336611;
            padding: 30px 25px;
            margin-bottom: 30px;
        }
        .form-section h2 {
            margin-top: 0;
            margin-bottom: 20px;
            color: #003366;
        }
        .form-section form {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            align-items: flex-end;
        }
        .form-section form input[type="text"],
        .form-section form input[type="number"],
        .form-section form select {
            flex: 1 1 200px;
            padding: 10px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            box-sizing: border-box;
        }
        .form-section form button {
            background: #4f8cff;
            color: #fff;
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: background 0.2s;
        }
        .form-section form button:hover {
            background: #003366;
        }
  /*]]>*/
  </style>
</head>

<body>
  <div class="notification-bar" id="notificationBar"></div>

  <div class="container">
    <div class="sidebar">
      <h2>بوابة سوق البدو</h2>

      <ul>
        <li class="active" onclick="showSection('home', this)"><i class="fas fa-home"></i>
        الرئيسية</li>

        <li onclick="showSection('users', this)"><i class="fa-solid fa-users"></i> إدارة المستخدمين</li>
        <    <li class="has-submenu" onclick="toggleSubMenu(this)"><i class="fa-solid fa-user-group"></i> العملاء و الموردين <i class="fa-solid fa-chevron-down"></i></li>
        <ul class="submenu">
            <li onclick="showSection('suppliers', this)"><i class="fa-solid fa-truck"></i> الموردين</li>
            <li onclick="showSection('clients', this)"><i class="fa-solid fa-user"></i> العملاء</li>
            <li onclick="showSection('cashclient', this)"><i class="fa-solid fa-money-bill"></i> عميل نقدي</li>
            <li onclick="showSection('clientgroups', this)"><i class="fa-solid fa-layer-group"></i> مجموعات العملاء</li>

        </ul>
        <li class="has-submenu" onclick="toggleSubMenu(this)"><i class="fa-solid fa-user-group"></i>الاصناف<i class="fa-solid fa-chevron-down"></i></li>
        <ul class="submenu">
            <li onclick="showSection('suppliers', this)"><i class="fa-solid fa-list-ul"></i> قائمة الاصناف</li>
            <li onclick="showSection('clients', this)"><i class="fa-solid fa-plus"></i> اضافة صنف</li>
        <li onclick="showSection('purchases', this)"><i class="fas fa-shopping-cart"></i>
            <li onclick="showSection('cashclient', this)"><i class="fa-solid fa-money-bill"></i>  خصم الاصناف </li>
            <li onclick="showSection('clientgroups', this)"><i class="fa-solid fa-layer-group"></i>  تصنيفات الاصناف</li>
            
        </ul>
            <li onclick="showSection('purchases', this)"><i class="fa-solid fa-cart-shopping"></i> المشتريات</li>
            <li onclick="showSection('sales', this)"><i class="fa-solid fa-cash-register"></i> المبيعات</li>
            <li onclick="showSection('inventory', this)"><i class="fa-solid fa-warehouse"></i> إدارة المخزون</li>
            <li onclick="showSection('accounts', this)"><i class="fa-solid fa-file-invoice-dollar"></i> الحسابات</li>
            <li onclick="showSection('reports', this)"><i class="fa-solid fa-chart-bar"></i> التقارير</li>
            <li onclick="showSection('settings', this)"><i class="fa-solid fa-gear"></i> إعدادات</li>
        </ul>
    </div>

    <div class="main-content">
      <div id="home" class="section active">
        <div class="cards">
          <div class="card">
            <i class="fas fa-users"></i> <span class="label">إجمالي
            العملاء</span><span class="value">0</span>
          </div>

          <div class="card">
            <i class="fas fa-money-bill-wave"></i> <span class="label">إجمالي
            المبيعات</span><span class="value">0 ر.س</span>
          </div>

          <div class="card">
            <i class="fas fa-shopping-basket"></i> <span class="label">إجمالي
            المشتريات</span><span class="value">0 ر.س</span>
          </div>

          <div class="card">
            <i class="fas fa-warehouse"></i> <span class="label">رصيد
            المخزون</span><span class="value">0 ر.س</span>
          </div>
        </div>

        <div class="chart-container">
          <canvas id="mainChart"></canvas>
        </div>
      </div>

      <div id="users" class="section">
        <div class="form-section">
          <h2>إدارة المستخدمين</h2>

          <form>
            <input type="text" placeholder="اسم المستخدم" /><button>إضافة
            مستخدم</button>
          </form>
        </div>
      </div>

      <div id="suppliers" class="section">
        <div class="form-section">
          <!DOCTYPE html>
          <html lang="ar" dir="rtl">
          <head>
            <meta charset="UTF-8">
            <title>برنامج محاسبة شخصي</title>
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <!-- Font Awesome & Bootstrap (minified CDN) -->
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
            <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.rtl.min.css" rel="stylesheet">
            <style>
              body {
                font-family: 'Cairo', sans-serif;
                background: #f9f9f9;
                padding: 20px;
              }
              .form-section {
                background: #fff;
                padding: 25px;
                border-radius: 12px;
                box-shadow: 0 2px 10px #0001;
                margin-bottom: 30px;
              }
              h2 {
                margin-bottom: 20px;
                color: #003366;
              }
              .notification-bar {
                display: none;
                text-align: center;
                padding: 10px;
                color: white;
                margin-bottom: 20px;
                border-radius: 6px;
              }
              .table-container {
                overflow-x: auto;
              }
              .action-btn {
                padding: 5px 10px;
                border-radius: 6px;
                border: none;
                cursor: pointer;
              }
              .edit-btn {
                background: #ffd700;
                color: #222;
              }
              .delete-btn {
                background: #ff4f4f;
                color: white;
              }
            </style>
          </head>
          <body>
            <div id="notificationBar" class="notification-bar"></div>
            <div class="form-section">
              <h2>إضافة مورد</h2>
              <form id="supplierForm">
                <div class="row g-3">
                  <div class="col-md-3"><input type="text" id="supplierName" class="form-control" placeholder="اسم المورد" required></div>
                  <div class="col-md-3"><input type="text" id="supplierPhone" class="form-control" placeholder="رقم الجوال" required></div>
                  <div class="col-md-3"><input type="text" id="supplierTaxId" class="form-control" placeholder="الرقم الضريبي" required></div>
                  <div class="col-md-3"><input type="text" id="supplierAddress" class="form-control" placeholder="العنوان" required></div>
                </div>
                <button type="submit" class="btn btn-primary mt-3">إضافة المورد</button>
              </form>
            </div>
            <div class="table-container form-section">
              <h2>قائمة الموردين</h2>
              <table class="table table-striped table-bordered">
                <thead class="table-light">
                  <tr>
                    <th>#</th>
                    <th>اسم المورد</th>
                    <th>رقم الجوال</th>
                    <th>الرقم الضريبي</th>
                    <th>العنوان</th>
                    <th>إجراءات</th>
                  </tr>
                </thead>
                <tbody id="suppliersTableBody">
                  <!-- بيانات الموردين تُضاف هنا تلقائيًا -->
                </tbody>
              </table>
            </div>
            <script>
              // دالة الإشعار
              function showNotification(message, type = 'success') {
                const bar = document.getElementById('notificationBar');
                bar.textContent = message;
                bar.style.display = 'block';
                bar.style.backgroundColor = type === 'success' ? '#28a745' : '#dc3545';
                setTimeout(() => {
                  bar.style.display = 'none';
                }, 3000);
              }
              // التعامل مع نموذج المورد
              document.getElementById('supplierForm').addEventListener('submit', function (event) {
                event.preventDefault();
                const name = document.getElementById('supplierName').value;
                const phone = document.getElementById('supplierPhone').value;
                const taxId = document.getElementById('supplierTaxId').value;
                const address = document.getElementById('supplierAddress').value;
                fetch('http://localhost:3000/api/suppliers', {
                  method: 'POST',
                  headers: { 'Content-Type': 'application/json' },
                  body: JSON.stringify({ name, phone, taxId, address })
                })
                .then(response => response.json())
                .then(data => {
                  showNotification('✅ تم إضافة المورد بنجاح!');
                  appendSupplierToTable(data);
                  document.getElementById('supplierForm').reset();
                })
                .catch(error => {
                  showNotification('❌ حدث خطأ أثناء الإضافة.', 'error');
                  console.error(error);
                });
              });
              // تفويض الأحداث لأزرار الجدول (تعديل/حذف)
              document.getElementById('suppliersTableBody').addEventListener('click', function(e) {
                if (e.target.classList.contains('edit-btn')) {
                  alert('تعديل المورد قادم قريباً');
                } else if (e.target.classList.contains('delete-btn')) {
                  alert('حذف المورد قادم قريباً');
                }
              });
              // تحميل الموردين دفعة واحدة
              window.addEventListener('DOMContentLoaded', () => {
                fetch('http://localhost:3000/api/suppliers')
                  .then(response => response.json())
                  .then(data => {
                    let rows = '';
                    data.forEach(supplier => {
                      rows += `
                        <tr>
                          <td>${supplier._id.slice(-4)}</td>
                          <td>${supplier.name}</td>
                          <td>${supplier.phone}</td>
                          <td>${supplier.taxId}</td>
                          <td>${supplier.address}</td>
                          <td>
                            <button class="action-btn edit-btn">تعديل</button>
                            <button class="action-btn delete-btn">حذف</button>
                          </td>
                        </tr>
                      `;
                    });
                    document.getElementById('suppliersTableBody').innerHTML = rows;
                  })
                  .catch(err => console.error('فشل تحميل الموردين:', err));
              });
              // دالة لإضافة مورد جديد إلى الجدول مباشرة بعد الإضافة
              function appendSupplierToTable(supplier) {
                const tableBody = document.getElementById('suppliersTableBody');
                const row = document.createElement('tr');
                row.innerHTML = `
                  <td>${supplier._id.slice(-4)}</td>
                  <td>${supplier.name}</td>
                  <td>${supplier.phone}</td>
                  <td>${supplier.taxId}</td>
                  <td>${supplier.address}</td>
                  <td>
                    <button class="action-btn edit-btn">تعديل</button>
                    <button class="action-btn delete-btn">حذف</button>
                  </td>
                `;
                tableBody.appendChild(row);
              }
            </script>
          </body>
          </html>
          <div id="clientgroups" class="section">
            <div class="form-section">
          <h2>العملاء</h2>
          <form id="clientForm">
            <input type="text" id="clientName" placeholder="اسم العميل" required="" />
            <button type="submit">إضافة عميل</button>
          </form>
        </div>
      </div>

      <div id="cashclient" class="section">
        <div class="form-section">
          <h2>عميل نقدي</h2>

          <form>
            <input type="text" placeholder="اسم العميل النقدي" /><button>إضافة</button>
          </form>
        </div>
      </div>

      <div id="clientgroups" class="section">
        <div class="form-section">
          <h2>مجموعات العملاء</h2>

          <form>
            <input type="text" placeholder="اسم المجموعة" /><button>إضافة
            مجموعة</button>
          </form>
        </div>
      </div>

      <div id="itemsList" class="section">
        <div class="form-section">
          <h2>قائمة الاصناف</h2>

          <form>
            <input type="text" placeholder="اسم الصنف أو الكود" /><button>بحث</button>
          </form>
        </div>
      </div>

      <div id="addItem" class="section">
        <div class="form-section">
          <h2>اضافة صنف</h2>

          <form>
            <input type="text" placeholder="اسم الصنف" /><button>إضافة صنف</button>
          </form>
        </div>
      </div>

      <div id="discountItem" class="section">
        <div class="form-section">
          <h2>خصم الاصناف</h2>

          <form>
            <input type="text" placeholder="اسم الصنف" /><button>تطبيق الخصم</button>
          </form>
        </div>
      </div>

      <div id="itemCategories" class="section">
        <div class="form-section">
          <h2>تصنيفات الاصناف</h2>

          <form>
            <input type="text" placeholder="اسم التصنيف" /><button>إضافة
            تصنيف</button>
          </form>
        </div>
      </div>

      <div id="purchases" class="section">
        <div class="form-section">
          <h2>المشتريات</h2>

          <form>
            <input type="text" placeholder="رقم الفاتورة" /><button>بحث</button>
          </form>
        </div>
      </div>

      <div id="sales" class="section">
        <div class="form-section">
          <h2>المبيعات</h2>

          <form>
            <input type="text" placeholder="رقم الفاتورة" /><button>بحث</button>
          </form>
        </div>
      </div>

      <div id="inventory" class="section">
        <div class="form-section">
          <h2>إدارة المخزون</h2>

          <form>
            <input type="text" placeholder="اسم الصنف أو الكود" /><button>بحث</button>
          </form>
        </div>
      </div>

      <div id="accounts" class="section">
        <div class="form-section">
          <h2>الحسابات</h2>

          <form>
            <input type="text" placeholder="اسم الحساب" /><button>بحث</button>
          </form>
        </div>
      </div>

      <div id="reports" class="section">
        <div class="chart-container">
          <canvas id="fullReportsChart"></canvas>
        </div>
      </div>

      <div id="zakat" class="section">
        <div class="form-section">
          <h2>الربط مع هيئة الزكاة</h2>

          <form>
            <input type="text" placeholder="رقم التسجيل الضريبي" /><button>ربط</button>
          </form>
        </div>
      </div>

      <div id="settings" class="section">
        <div class="form-section">
          <h2>اعدادات</h2>

          <form>
            <input type="text" placeholder="إعداد" /><button>حفظ</button>
          </form>
        </div>
      </div>
    </div>
  </div><script type="text/javascript">
//<![CDATA[
    function showSection(id, el) {
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        document.querySelectorAll('.sidebar ul li').forEach(li => li.classList.remove('active'));
        if(el) {
            let parentLi = el;
            while(parentLi && !parentLi.classList.contains('has-submenu') && parentLi.tagName !== 'UL') {
                parentLi = parentLi.parentElement;
            }
            if(parentLi && parentLi.tagName === 'LI') {
                parentLi.classList.add('active');
            } else {
                el.classList.add('active');
            }
        }

        // Close all submenus when changing main section
        document.querySelectorAll('.submenu').forEach(submenu => {
            submenu.style.display = 'none';
            if(submenu.previousElementSibling && submenu.previousElementSibling.classList.contains('has-submenu')) {
                submenu.previousElementSibling.classList.remove('open');
            }
        });
    }

    function toggleSubMenu(li) {
        li.classList.toggle('open');
        var submenu = li.nextElementSibling;
        if(submenu && submenu.classList.contains('submenu')) {
            submenu.style.display = submenu.style.display === 'block' ? 'none' : 'block';
        }
    }

    // Notification function
    function showNotification(message, type = 'success') {
        const notificationBar = document.getElementById('notificationBar');
        notificationBar.textContent = message;
        notificationBar.style.backgroundColor = type === 'success' ? '#4CAF50' : '#f44336';
        notificationBar.style.display = 'block';
        setTimeout(() => {
            notificationBar.style.display = 'none';
        }, 3000); // Hide after 3 seconds
    }

    // Save Client function
    document.getElementById('clientForm').addEventListener('submit', function(event) {
        event.preventDefault();
        const clientName = document.getElementById('clientName').value;

        fetch('http://localhost:3000/api/clients', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ name: clientName }),
        })
        .then(response => response.json())
        .then(data => {
            console.log('Success:', data);
            showNotification('تم حفظ العميل بنجاح!', 'success');
            document.getElementById('clientName').value = ''; // Clear input
            // Timer before returning to home
            // setTimeout(() => {
            //     showSection('home', document.querySelector('.sidebar ul li.active')); // Go back to home section
            // }, 2000); // 2-second delay
        })
        .catch((error) => {
            console.error('Error:', error);
            showNotification('حدث خطأ أثناء حفظ العميل.', 'error');
        });
    });

    // Save Supplier function
    document.getElementById('supplierForm').addEventListener('submit', function(event) {
        event.preventDefault();
        const supplierName = document.getElementById('supplierName').value;
        const supplierPhone = document.getElementById('supplierPhone').value;
        const supplierTaxId = document.getElementById('supplierTaxId').value;
        const supplierAddress = document.getElementById('supplierAddress').value;

        fetch('http://localhost:3000/api/suppliers', { // Assuming a new API endpoint for suppliers
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ 
                name: supplierName,
                phone: supplierPhone,
                taxId: supplierTaxId,
                address: supplierAddress
            }),
        })
        .then(response => response.json())
        .then(data => {
            console.log('Success:', data);
            showNotification('تم حفظ المورد بنجاح!', 'success');
            // Clear input fields
            document.getElementById('supplierName').value = '';
            document.getElementById('supplierPhone').value = '';
            document.getElementById('supplierTaxId').value = '';
            document.getElementById('supplierAddress').value = '';
            // Optionally, refresh the suppliers table or add the new supplier to it dynamically
        })
        .catch((error) => {
            console.error('Error:', error);
            showNotification('حدث خطأ أثناء حفظ المورد.', 'error');
        });
    });

    // رسم بياني للصفحة الرئيسية
    var ctx = document.getElementById('mainChart').getContext('2d');
    new Chart(ctx, {
        type: 'bar',
        data: {
            labels: ['يناير', 'فبراير', 'مارس', 'ابريل', 'مايو', 'يونيو'],
            datasets: [
                { label: 'المبيعات', data: [5000, 7000, 6000, 8000, 4000, 5000], backgroundColor: '#4f8cff' },
                { label: 'المشتريات', data: [2000, 3000, 2500, 4000, 1500, 2000], backgroundColor: '#ffd700' }
            ]
        },
        options: { responsive:true, plugins:{legend:{display:true}} }
    });

    // رسم بياني لصفحة التقارير
    var ctx2 = document.getElementById('fullReportsChart').getContext('2d');
    new Chart(ctx2, {
        type: 'line',
        data: {
            labels: ['يناير', 'فبراير', 'مارس', 'ابريل', 'مايو', 'يونيو', 'يوليو', 'اغسطس', 'سبتمبر', 'اكتوبر', 'نوفمبر', 'ديسمبر'],
            datasets: [
                { label: 'الإيرادات', data: [1000, 1200, 1500, 1300, 1800, 2000, 2200, 2100, 2500, 2300, 2700, 3000], borderColor: '#1bcfcf', fill: false },
                { label: 'المصروفات', data: [500, 600, 700, 650, 800, 900, 1000, 950, 1100, 1050, 1200, 1300], borderColor: '#ff4f4f', fill: false }
            ]
        },
        options: { responsive:true, plugins:{legend:{display:true}} }
    });
  //]]>
  </script>
</body>
</html> 